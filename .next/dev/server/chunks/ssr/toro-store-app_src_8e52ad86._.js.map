{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dwiya/.gemini/antigravity/scratch/toro-store-app/src/actions/package.ts"],"sourcesContent":["'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { revalidatePath } from 'next/cache';\r\nimport { writeFile, mkdir } from 'fs/promises';\r\nimport path from 'path';\r\n\r\nexport async function getPackages() {\r\n  try {\r\n    return await prisma.package.findMany({\r\n      where: { isActive: true },\r\n      orderBy: [{ sortOrder: 'asc' }, { createdAt: 'asc' }],\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to fetch packages:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getAdminPackages() {\r\n  try {\r\n    return await prisma.package.findMany({\r\n      orderBy: [{ sortOrder: 'asc' }, { createdAt: 'asc' }],\r\n      include: { _count: { select: { orders: true } } },\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to fetch admin packages:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getPackageById(id: string) {\r\n  try {\r\n    return await prisma.package.findUnique({ where: { id } });\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function createPackage(data: {\r\n  name: string;\r\n  description?: string;\r\n  price: string;\r\n  category: string;\r\n  imageUrl?: string;\r\n  stock: number;\r\n  isActive: boolean;\r\n  sortOrder: number;\r\n}) {\r\n  try {\r\n    await prisma.package.create({ data });\r\n    revalidatePath('/');\r\n    revalidatePath('/admin/packages');\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Failed to create package:', error);\r\n    return { success: false, error: 'Gagal membuat paket.' };\r\n  }\r\n}\r\n\r\nexport async function updatePackage(\r\n  id: string,\r\n  data: {\r\n    name?: string;\r\n    description?: string;\r\n    price?: string;\r\n    category?: string;\r\n    imageUrl?: string;\r\n    stock?: number;\r\n    isActive?: boolean;\r\n    sortOrder?: number;\r\n  }\r\n) {\r\n  try {\r\n    await prisma.package.update({ where: { id }, data });\r\n    revalidatePath('/');\r\n    revalidatePath('/admin/packages');\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Failed to update package:', error);\r\n    return { success: false, error: 'Gagal mengupdate paket.' };\r\n  }\r\n}\r\n\r\nexport async function deletePackage(id: string) {\r\n  try {\r\n    await prisma.package.delete({ where: { id } });\r\n    revalidatePath('/');\r\n    revalidatePath('/admin/packages');\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Failed to delete package:', error);\r\n    return { success: false, error: 'Gagal menghapus paket. Mungkin masih ada order terkait.' };\r\n  }\r\n}\r\n\r\nexport async function uploadPackageImage(formData: FormData): Promise<{ success: boolean; url?: string; error?: string }> {\r\n  try {\r\n    const file = formData.get('file') as File;\r\n    if (!file || file.size === 0) return { success: false, error: 'File tidak ditemukan.' };\r\n\r\n    const allowed = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];\r\n    if (!allowed.includes(file.type)) return { success: false, error: 'Format tidak didukung. Gunakan JPG, PNG, atau WebP.' };\r\n\r\n    if (file.size > 5 * 1024 * 1024) return { success: false, error: 'Ukuran file maksimal 5MB.' };\r\n\r\n    const ext = file.name.split('.').pop();\r\n    const filename = `pkg_${Date.now()}.${ext}`;\r\n    const uploadDir = path.join(process.cwd(), 'public', 'uploads');\r\n    await mkdir(uploadDir, { recursive: true });\r\n\r\n    const buffer = Buffer.from(await file.arrayBuffer());\r\n    await writeFile(path.join(uploadDir, filename), buffer);\r\n\r\n    return { success: true, url: `/uploads/${filename}` };\r\n  } catch (error) {\r\n    console.error('Upload failed:', error);\r\n    return { success: false, error: 'Upload gagal.' };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAoFsB,wBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA,iDAAA"}},
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dwiya/.gemini/antigravity/scratch/toro-store-app/src/actions/package.ts"],"sourcesContent":["'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { revalidatePath } from 'next/cache';\r\nimport { writeFile, mkdir } from 'fs/promises';\r\nimport path from 'path';\r\n\r\nexport async function getPackages() {\r\n  try {\r\n    return await prisma.package.findMany({\r\n      where: { isActive: true },\r\n      orderBy: [{ sortOrder: 'asc' }, { createdAt: 'asc' }],\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to fetch packages:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getAdminPackages() {\r\n  try {\r\n    return await prisma.package.findMany({\r\n      orderBy: [{ sortOrder: 'asc' }, { createdAt: 'asc' }],\r\n      include: { _count: { select: { orders: true } } },\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to fetch admin packages:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getPackageById(id: string) {\r\n  try {\r\n    return await prisma.package.findUnique({ where: { id } });\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function createPackage(data: {\r\n  name: string;\r\n  description?: string;\r\n  price: string;\r\n  category: string;\r\n  imageUrl?: string;\r\n  stock: number;\r\n  isActive: boolean;\r\n  sortOrder: number;\r\n}) {\r\n  try {\r\n    await prisma.package.create({ data });\r\n    revalidatePath('/');\r\n    revalidatePath('/admin/packages');\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Failed to create package:', error);\r\n    return { success: false, error: 'Gagal membuat paket.' };\r\n  }\r\n}\r\n\r\nexport async function updatePackage(\r\n  id: string,\r\n  data: {\r\n    name?: string;\r\n    description?: string;\r\n    price?: string;\r\n    category?: string;\r\n    imageUrl?: string;\r\n    stock?: number;\r\n    isActive?: boolean;\r\n    sortOrder?: number;\r\n  }\r\n) {\r\n  try {\r\n    await prisma.package.update({ where: { id }, data });\r\n    revalidatePath('/');\r\n    revalidatePath('/admin/packages');\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Failed to update package:', error);\r\n    return { success: false, error: 'Gagal mengupdate paket.' };\r\n  }\r\n}\r\n\r\nexport async function deletePackage(id: string) {\r\n  try {\r\n    await prisma.package.delete({ where: { id } });\r\n    revalidatePath('/');\r\n    revalidatePath('/admin/packages');\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Failed to delete package:', error);\r\n    return { success: false, error: 'Gagal menghapus paket. Mungkin masih ada order terkait.' };\r\n  }\r\n}\r\n\r\nexport async function uploadPackageImage(formData: FormData): Promise<{ success: boolean; url?: string; error?: string }> {\r\n  try {\r\n    const file = formData.get('file') as File;\r\n    if (!file || file.size === 0) return { success: false, error: 'File tidak ditemukan.' };\r\n\r\n    const allowed = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];\r\n    if (!allowed.includes(file.type)) return { success: false, error: 'Format tidak didukung. Gunakan JPG, PNG, atau WebP.' };\r\n\r\n    if (file.size > 5 * 1024 * 1024) return { success: false, error: 'Ukuran file maksimal 5MB.' };\r\n\r\n    const ext = file.name.split('.').pop();\r\n    const filename = `pkg_${Date.now()}.${ext}`;\r\n    const uploadDir = path.join(process.cwd(), 'public', 'uploads');\r\n    await mkdir(uploadDir, { recursive: true });\r\n\r\n    const buffer = Buffer.from(await file.arrayBuffer());\r\n    await writeFile(path.join(uploadDir, filename), buffer);\r\n\r\n    return { success: true, url: `/uploads/${filename}` };\r\n  } catch (error) {\r\n    console.error('Upload failed:', error);\r\n    return { success: false, error: 'Upload gagal.' };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MA4DsB,wBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA,iDAAA"}},
    {"offset": {"line": 32, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dwiya/.gemini/antigravity/scratch/toro-store-app/src/components/PackageActions.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { deletePackage, updatePackage } from '@/actions/package';\r\n\r\ntype Props = {\r\n  id: string;\r\n  name: string;\r\n  isActive: boolean;\r\n};\r\n\r\nexport function PackageActions({ id, name, isActive }: Props) {\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleToggle = async () => {\r\n    setLoading(true);\r\n    await updatePackage(id, { isActive: !isActive });\r\n    router.refresh();\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!confirm(`Hapus paket \"${name}\"? Order terkait tidak bisa diakses lagi.`)) return;\r\n    setLoading(true);\r\n    const res = await deletePackage(id);\r\n    if (!res.success) alert(res.error);\r\n    router.refresh();\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex gap-2 mt-4 pt-4 border-t border-neutral-800\">\r\n      <button\r\n        onClick={() => router.push(`/admin/packages/${id}/edit`)}\r\n        className=\"flex-1 text-center text-sm font-semibold py-2 px-3 bg-neutral-800 hover:bg-neutral-700 rounded-lg transition-colors\"\r\n        disabled={loading}\r\n      >\r\n        <i className=\"fa-solid fa-pen-to-square mr-1.5\"></i>Edit\r\n      </button>\r\n      <button\r\n        onClick={handleToggle}\r\n        disabled={loading}\r\n        className={`text-sm font-semibold py-2 px-3 rounded-lg transition-colors disabled:opacity-50 ${\r\n          isActive\r\n            ? 'bg-amber-500/10 text-amber-400 hover:bg-amber-500/20'\r\n            : 'bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20'\r\n        }`}\r\n      >\r\n        <i className={`fa-solid ${isActive ? 'fa-eye-slash' : 'fa-eye'} mr-1.5`}></i>\r\n        {isActive ? 'Nonaktif' : 'Aktifkan'}\r\n      </button>\r\n      <button\r\n        onClick={handleDelete}\r\n        disabled={loading}\r\n        className=\"text-sm font-semibold py-2 px-3 bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-lg transition-colors disabled:opacity-50\"\r\n      >\r\n        <i className=\"fa-solid fa-trash\"></i>\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAJA;;;;;AAYO,SAAS,eAAe,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAS;IAC1D,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,MAAM,eAAe;QACnB,WAAW;QACX,MAAM,IAAA,+LAAa,EAAC,IAAI;YAAE,UAAU,CAAC;QAAS;QAC9C,OAAO,OAAO;QACd,WAAW;IACb;IAEA,MAAM,eAAe;QACnB,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE,KAAK,yCAAyC,CAAC,GAAG;QAC/E,WAAW;QACX,MAAM,MAAM,MAAM,IAAA,+LAAa,EAAC;QAChC,IAAI,CAAC,IAAI,OAAO,EAAE,MAAM,IAAI,KAAK;QACjC,OAAO,OAAO;QACd,WAAW;IACb;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,SAAS,IAAM,OAAO,IAAI,CAAC,CAAC,gBAAgB,EAAE,GAAG,KAAK,CAAC;gBACvD,WAAU;gBACV,UAAU;;kCAEV,8OAAC;wBAAE,WAAU;;;;;;oBAAuC;;;;;;;0BAEtD,8OAAC;gBACC,SAAS;gBACT,UAAU;gBACV,WAAW,CAAC,iFAAiF,EAC3F,WACI,yDACA,8DACJ;;kCAEF,8OAAC;wBAAE,WAAW,CAAC,SAAS,EAAE,WAAW,iBAAiB,SAAS,OAAO,CAAC;;;;;;oBACtE,WAAW,aAAa;;;;;;;0BAE3B,8OAAC;gBACC,SAAS;gBACT,UAAU;gBACV,WAAU;0BAEV,cAAA,8OAAC;oBAAE,WAAU;;;;;;;;;;;;;;;;;AAIrB"}}]
}