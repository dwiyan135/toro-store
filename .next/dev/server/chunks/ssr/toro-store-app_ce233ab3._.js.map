{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dwiya/.gemini/antigravity/scratch/toro-store-app/src/actions/auth.ts"],"sourcesContent":["'use server';\r\n\r\nimport { SignJWT } from 'jose';\r\nimport { cookies } from 'next/headers';\r\n\r\nconst secret = new TextEncoder().encode(\r\n  process.env.ADMIN_PASSWORD || 'admin_toro_fallback_secret_key'\r\n);\r\n\r\nexport async function login(password: string) {\r\n  const adminPassword = process.env.ADMIN_PASSWORD || 'admin_toro';\r\n\r\n  if (password !== adminPassword) {\r\n    return { error: 'Password salah' };\r\n  }\r\n\r\n  // Create JWT token using edge-compatible formatting\r\n  const token = await new SignJWT({ admin: true })\r\n    .setProtectedHeader({ alg: 'HS256' })\r\n    .setIssuedAt()\r\n    .setExpirationTime('24h') // Set 24 hour session\r\n    .sign(secret);\r\n\r\n  const cookieStore = await cookies();\r\n  cookieStore.set('admin_session', token, {\r\n    httpOnly: true,\r\n    secure: process.env.NODE_ENV === 'production',\r\n    sameSite: 'lax',\r\n    path: '/admin', // Scope to admin area\r\n    maxAge: 60 * 60 * 24, // 24 hours\r\n  });\r\n\r\n  return { success: true };\r\n}\r\n\r\nexport async function logout() {\r\n  const cookieStore = await cookies();\r\n  cookieStore.delete('admin_session');\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;;;AAEA,MAAM,SAAS,IAAI,cAAc,MAAM,CACrC,QAAQ,GAAG,CAAC,cAAc,IAAI;AAGzB,eAAe,MAAM,QAAgB;IAC1C,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IAEpD,IAAI,aAAa,eAAe;QAC9B,OAAO;YAAE,OAAO;QAAiB;IACnC;IAEA,oDAAoD;IACpD,MAAM,QAAQ,MAAM,IAAI,gKAAO,CAAC;QAAE,OAAO;IAAK,GAC3C,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,OAAO,sBAAsB;KAC/C,IAAI,CAAC;IAER,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,GAAG,CAAC,iBAAiB,OAAO;QACtC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,MAAM;QACN,QAAQ,KAAK,KAAK;IACpB;IAEA,OAAO;QAAE,SAAS;IAAK;AACzB;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,MAAM,CAAC;AACrB;;;IA7BsB;IA0BA;;AA1BA,+OAAA;AA0BA,+OAAA"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/dwiya/.gemini/antigravity/scratch/toro-store-app/.next-internal/server/app/admin/stock/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {logout as '00dc57a7e72aa127a22f927d7f8e3616ac24788e84'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}