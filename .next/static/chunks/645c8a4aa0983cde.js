(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78619,e=>{"use strict";var a=e.i(95187);let t=(0,a.createServerReference)("60fdbde4d29d67209ccf4876f8d564273206849906",a.callServer,void 0,a.findSourceMapURL,"updatePackage");e.s(["updatePackage",()=>t])},36785,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(95187);let l=(0,s.createServerReference)("4055b326a74a867b2261dc8bfe76b04b8b931db590",s.callServer,void 0,s.findSourceMapURL,"getPackageById");var r=e.i(78619),i=e.i(18566),n=e.i(70319);function o(e){return e.replace(/\D/g,"")}function c({params:e}){let s,{id:c}=(0,t.use)(e),d=(0,i.useRouter)(),u=(0,t.useRef)(null),[x,m]=(0,t.useState)(""),[b,p]=(0,t.useState)(""),[h,f]=(0,t.useState)(""),[g,j]=(0,t.useState)(""),[N,v]=(0,t.useState)(""),[k,y]=(0,t.useState)(0),[w,S]=(0,t.useState)(!0),[P,C]=(0,t.useState)(""),[R,U]=(0,t.useState)(""),[F,M]=(0,t.useState)(!1),[T,L]=(0,t.useState)(!1),[B,D]=(0,t.useState)(!0),G=function(e){if(!e)return"";let a=parseInt(e,10);return isNaN(a)?"":"Rp "+a.toLocaleString("id-ID")}(h),I=parseInt(N||"0",10);(0,t.useEffect)(()=>{l(c).then(e=>{e?(m(e.name),p(e.description||""),f(o(e.price)),j(e.category),v(e.stock.toString()),y(e.sortOrder),S(e.isActive),C(e.imageUrl||""),U(e.imageUrl||""),D(!1)):d.push("/admin/packages")}).catch(()=>{n.toast.error("Gagal memuat data paket."),D(!1)})},[c,d]);let K=async e=>{let a=e.target.files?.[0];if(!a)return;U(URL.createObjectURL(a)),M(!0);let t=new FormData;t.append("file",a);try{let e=await fetch("/api/upload",{method:"POST",body:t}),a=await e.json();a.success&&a.url?(C(a.url),n.toast.success("Gambar berhasil diupload!")):(n.toast.error(a.error||"Upload gagal"),U(P))}catch{n.toast.error("Upload gagal. Coba lagi."),U(P)}finally{M(!1)}},$=async e=>{if(e.preventDefault(),!x.trim())return void n.toast.error("Nama paket wajib diisi.");if(!h)return void n.toast.error("Harga wajib diisi.");if(!g)return void n.toast.error("Kategori wajib dipilih.");L(!0);let a=await (0,r.updatePackage)(c,{name:x.trim(),description:b.trim()||void 0,price:G,category:g,imageUrl:P||void 0,stock:I,isActive:w,sortOrder:k});a.success?(n.toast.success("Perubahan berhasil disimpan!"),setTimeout(()=>d.push("/admin/packages"),800)):(n.toast.error(a.error||"Gagal menyimpan paket."),L(!1))};return B?(0,a.jsx)("div",{className:"flex items-center justify-center py-24",children:(0,a.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full"})}):(0,a.jsxs)("div",{className:"max-w-2xl",children:[(0,a.jsxs)("header",{className:"mb-8 border-b border-neutral-800 pb-5",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Edit Paket"}),(0,a.jsx)("p",{className:"text-neutral-400 mt-1",children:"Perbarui informasi paket gift skin."})]}),(0,a.jsxs)("form",{onSubmit:$,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Gambar Paket"}),(0,a.jsxs)("div",{className:"relative h-48 bg-neutral-900 border-2 border-dashed border-neutral-700 hover:border-blue-500/50 rounded-xl cursor-pointer transition-colors overflow-hidden",onClick:()=>u.current?.click(),children:[R?(0,a.jsx)("img",{src:R,alt:"preview",className:"w-full h-full object-cover"}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-2 text-neutral-500",children:[(0,a.jsx)("i",{className:"fa-solid fa-cloud-arrow-up text-3xl"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Klik untuk ganti gambar"}),(0,a.jsx)("span",{className:"text-xs",children:"JPG, PNG, WebP — maks. 10MB"})]}),F&&(0,a.jsxs)("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center gap-2",children:[(0,a.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full"}),(0,a.jsx)("span",{className:"text-xs text-neutral-400",children:"Mengupload & konversi ke WebP..."})]}),P&&!F&&(0,a.jsxs)("div",{className:"absolute bottom-2 left-2 right-2 flex items-center gap-1.5 bg-emerald-500/20 border border-emerald-500/30 px-2.5 py-1.5 rounded-lg",children:[(0,a.jsx)("i",{className:"fa-solid fa-check text-emerald-400 text-xs"}),(0,a.jsx)("span",{className:"text-xs text-emerald-400 font-medium",children:"Gambar sudah diset"}),(0,a.jsxs)("button",{type:"button",onClick:e=>{e.stopPropagation(),C(""),U("")},className:"ml-auto text-neutral-500 hover:text-red-400 transition-colors text-xs",children:[(0,a.jsx)("i",{className:"fa-solid fa-xmark"})," Hapus"]})]})]}),(0,a.jsx)("input",{ref:u,type:"file",accept:"image/*",className:"hidden",onChange:K})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)("label",{className:"block text-sm font-semibold text-neutral-300",children:["Nama Paket ",(0,a.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,a.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl px-4 py-3 text-white placeholder:text-neutral-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none"})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)("label",{className:"block text-sm font-semibold text-neutral-300",children:["Kategori ",(0,a.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("select",{value:g,onChange:e=>j(e.target.value),className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl px-4 py-3 text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none appearance-none cursor-pointer",children:[(0,a.jsx)("option",{value:"",children:"Pilih Kategori..."}),(0,a.jsx)("option",{value:"Basic",children:"Basic"}),(0,a.jsx)("option",{value:"Premium",children:"Premium"}),(0,a.jsx)("option",{value:"Special",children:"Special"}),(0,a.jsx)("option",{value:"Event",children:"Event"}),(0,a.jsx)("option",{value:"Limited",children:"Limited"})]}),(0,a.jsx)("i",{className:"fa-solid fa-chevron-down absolute right-4 top-1/2 -translate-y-1/2 text-neutral-500 text-xs pointer-events-none"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Deskripsi"}),(0,a.jsx)("textarea",{value:b,onChange:e=>p(e.target.value),rows:3,className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl px-4 py-3 text-white placeholder:text-neutral-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none resize-none"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)("label",{className:"block text-sm font-semibold text-neutral-300",children:["Harga ",(0,a.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-neutral-500 font-semibold text-sm select-none",children:"Rp"}),(0,a.jsx)("input",{type:"text",inputMode:"numeric",value:h?parseInt(h,10).toLocaleString("id-ID"):"",onChange:e=>{f(o(e.target.value))},placeholder:"0",className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl pl-10 pr-4 py-3 text-white font-mono text-lg placeholder:text-neutral-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none"})]}),h?(0,a.jsxs)("p",{className:"text-xs text-amber-400 flex items-center gap-1",children:[(0,a.jsx)("i",{className:"fa-solid fa-tag"}),(s=parseInt(h||"0",10))?s>=1e12?`${(s/1e12).toFixed(2).replace(".",",")} Triliun`:s>=1e9?`${(s/1e9).toFixed(2).replace(".",",")} Miliar`:s>=1e6?`${(s/1e6).toFixed(2).replace(".",",")} Juta`:s>=1e3?`${(s/1e3).toFixed(0)} Ribu`:s.toString():""," · disimpan sebagai ",(0,a.jsx)("span",{className:"font-mono",children:G})]}):(0,a.jsx)("p",{className:"text-xs text-neutral-600",children:"Ketik angka saja, format otomatis — cth: 50000"})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Stok"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-neutral-500 text-sm select-none",children:(0,a.jsx)("i",{className:"fa-solid fa-boxes-stacked"})}),(0,a.jsx)("input",{type:"text",inputMode:"numeric",value:N,onChange:e=>{v(o(e.target.value))},placeholder:"0",className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl pl-10 pr-4 py-3 text-white font-mono text-lg placeholder:text-neutral-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none"})]}),(0,a.jsx)("p",{className:`text-xs flex items-center gap-1 ${0===I?"text-neutral-600":I<=5?"text-amber-400":"text-emerald-400"}`,children:0===I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"fa-solid fa-ban"})," Stok 0 — tidak bisa diorder"]}):I<=5?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"fa-solid fa-triangle-exclamation"})," Hampir habis — ",I," unit tersisa"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"fa-solid fa-check"})," ",I," unit tersedia"]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Urutan Tampil"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>y(Math.max(0,k-1)),className:"w-10 h-12 flex items-center justify-center bg-neutral-800 hover:bg-neutral-700 rounded-xl border border-neutral-700 text-neutral-300 transition-colors shrink-0",children:(0,a.jsx)("i",{className:"fa-solid fa-minus text-xs"})}),(0,a.jsx)("div",{className:"flex-1 bg-neutral-900 border border-neutral-700 rounded-xl px-3 py-3 text-center font-mono text-white text-lg font-bold",children:k}),(0,a.jsx)("button",{type:"button",onClick:()=>y(k+1),className:"w-10 h-12 flex items-center justify-center bg-neutral-800 hover:bg-neutral-700 rounded-xl border border-neutral-700 text-neutral-300 transition-colors shrink-0",children:(0,a.jsx)("i",{className:"fa-solid fa-plus text-xs"})})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-600",children:"Angka kecil muncul lebih dulu"})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Status Paket"}),(0,a.jsxs)("button",{type:"button",onClick:()=>S(!w),className:`w-full h-12 rounded-xl font-semibold text-sm transition-all border flex items-center justify-center gap-2 ${w?"bg-emerald-500/10 text-emerald-400 border-emerald-500/30 hover:bg-emerald-500/20":"bg-neutral-800 text-neutral-400 border-neutral-700 hover:bg-neutral-700"}`,children:[(0,a.jsx)("i",{className:`fa-solid ${w?"fa-eye":"fa-eye-slash"}`}),w?"Aktif — Tampil di publik":"Nonaktif — Disembunyikan"]}),(0,a.jsx)("p",{className:"text-xs text-neutral-600",children:w?"Pelanggan bisa melihat dan memesan paket ini.":"Paket tidak tampil di halaman utama."})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2 border-t border-neutral-800",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>d.back(),className:"px-6 py-3 rounded-xl bg-neutral-800 hover:bg-neutral-700 font-semibold transition-colors text-sm",children:[(0,a.jsx)("i",{className:"fa-solid fa-arrow-left mr-2 text-xs"})," Batal"]}),(0,a.jsx)("button",{type:"submit",disabled:T||F,className:"flex-1 py-3 px-6 bg-blue-500 hover:bg-blue-400 text-neutral-950 font-bold rounded-xl transition-all disabled:opacity-50 shadow-lg shadow-blue-500/20 text-sm",children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"fa-solid fa-circle-notch animate-spin mr-2"}),"Menyimpan..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"fa-solid fa-floppy-disk mr-2"}),"Simpan Perubahan"]})})]})]})]})}e.s(["default",()=>c],36785)}]);