module.exports=[6512,a=>{"use strict";var b=a.i(37936),c=a.i(59782),d=a.i(18558),e=a.i(24868),f=a.i(22734),g=a.i(14747),h=a.i(6971);async function i(){try{return await c.prisma.package.findMany({where:{isActive:!0},orderBy:[{sortOrder:"asc"},{createdAt:"asc"}]})}catch(a){return console.error("Failed to fetch packages:",a),[]}}async function j(){try{return await c.prisma.package.findMany({orderBy:[{sortOrder:"asc"},{createdAt:"asc"}],include:{_count:{select:{orders:!0}}}})}catch(a){return console.error("Failed to fetch admin packages:",a),[]}}async function k(a){try{return await c.prisma.package.findUnique({where:{id:a}})}catch{return null}}async function l(a){try{return await c.prisma.package.create({data:a}),(0,d.revalidatePath)("/"),(0,d.revalidatePath)("/admin/packages"),{success:!0}}catch(a){return console.error("Failed to create package:",a),{success:!1,error:"Gagal membuat paket."}}}async function m(a,b){try{return await c.prisma.package.update({where:{id:a},data:b}),(0,d.revalidatePath)("/"),(0,d.revalidatePath)("/admin/packages"),{success:!0}}catch(a){return console.error("Failed to update package:",a),{success:!1,error:"Gagal mengupdate paket."}}}async function n(a){try{let b=(await c.prisma.order.findMany({where:{packageId:a},select:{id:!0}})).map(a=>a.id);return b.length>0&&(await c.prisma.orderEvent.deleteMany({where:{orderId:{in:b}}}),await c.prisma.order.deleteMany({where:{id:{in:b}}})),await c.prisma.package.delete({where:{id:a}}),(0,d.revalidatePath)("/"),(0,d.revalidatePath)("/admin/packages"),(0,d.revalidatePath)("/admin"),{success:!0}}catch(a){return console.error("Failed to delete package:",a),{success:!1,error:"Gagal menghapus paket."}}}async function o(a){try{let b=(await c.prisma.order.findMany({where:{packageId:{in:a}},select:{id:!0}})).map(a=>a.id);return b.length>0&&(await c.prisma.orderEvent.deleteMany({where:{orderId:{in:b}}}),await c.prisma.order.deleteMany({where:{id:{in:b}}})),await c.prisma.package.deleteMany({where:{id:{in:a}}}),(0,d.revalidatePath)("/"),(0,d.revalidatePath)("/admin/packages"),(0,d.revalidatePath)("/admin"),{success:!0,count:a.length}}catch(a){return console.error("Failed to bulk delete:",a),{success:!1,error:"Gagal menghapus paket."}}}async function p(a,b){try{return await c.prisma.package.updateMany({where:{id:{in:a}},data:b}),(0,d.revalidatePath)("/"),(0,d.revalidatePath)("/admin/packages"),{success:!0,count:a.length}}catch(a){return console.error("Failed to bulk update:",a),{success:!1,error:"Gagal mengupdate paket."}}}async function q(a){try{let b,c=a.get("file");if(!c||0===c.size)return{success:!1,error:"File tidak ditemukan."};if(!["image/jpeg","image/png","image/webp","image/gif","image/avif"].includes(c.type))return{success:!1,error:"Format tidak didukung. Gunakan JPG, PNG, atau WebP."};if(c.size>0xa00000)return{success:!1,error:"Ukuran file maksimal 10MB."};let d=Buffer.from(await c.arrayBuffer()),i=await (0,h.default)(d).resize(1200,900,{fit:"inside",withoutEnlargement:!0}).webp({quality:82}).toBuffer(),j=`pkg_${Date.now()}.webp`,k=g.default.join((b=g.default.join(process.cwd(),"toro-store-app","public"),(0,f.existsSync)(b)?b:g.default.join(process.cwd(),"public")),"uploads");return await (0,e.mkdir)(k,{recursive:!0}),await (0,e.writeFile)(g.default.join(k,j),i),{success:!0,url:`/uploads/${j}`}}catch(a){return console.error("Upload failed:",a),{success:!1,error:"Upload gagal."}}}(0,a.i(13095).ensureServerEntryExports)([i,j,k,l,m,n,o,p,q]),(0,b.registerServerReference)(i,"00a26aa4c3a5962b0a0bbc37353b22e29acb27ad7d",null),(0,b.registerServerReference)(j,"00bf5bb6ae0836908cd09bca8b09567e320355edfe",null),(0,b.registerServerReference)(k,"4055b326a74a867b2261dc8bfe76b04b8b931db590",null),(0,b.registerServerReference)(l,"4025fd0bf5d8db3ddbd01d6012244b6fce0a3f9499",null),(0,b.registerServerReference)(m,"60fdbde4d29d67209ccf4876f8d564273206849906",null),(0,b.registerServerReference)(n,"40c36cea8ee0ea340a719713fe6416e15ae2c9f16b",null),(0,b.registerServerReference)(o,"400606749c04c88e038e57aabb785454ba0370a5e6",null),(0,b.registerServerReference)(p,"607c92be919f7a7a0f4c88af65e19c471f3103379d",null),(0,b.registerServerReference)(q,"407612e46e9b2b45a6e50b35ee21978acc5ef7167d",null),a.s(["bulkDeletePackages",()=>o,"bulkUpdatePackages",()=>p,"createPackage",()=>l,"deletePackage",()=>n,"getAdminPackages",()=>j,"getPackageById",()=>k,"getPackages",()=>i,"updatePackage",()=>m,"uploadPackageImage",()=>q])},37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},63681,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={RequestCookies:function(){return f.RequestCookies},ResponseCookies:function(){return f.ResponseCookies},stringifyCookie:function(){return f.stringifyCookie}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(36226)},4712,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ActionDidNotRevalidate:function(){return f},ActionDidRevalidateDynamicOnly:function(){return h},ActionDidRevalidateStaticAndDynamic:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=0,g=1,h=2},28340,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},31382,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={RenderStage:function(){return i},StagedRenderingController:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(50640),h=a.r(28340);var i=((d={})[d.Before=1]="Before",d[d.Static=2]="Static",d[d.Runtime=3]="Runtime",d[d.Dynamic=4]="Dynamic",d[d.Abandoned=5]="Abandoned",d);class j{constructor(a=null,b){this.abortSignal=a,this.hasRuntimePrefetch=b,this.currentStage=1,this.staticInterruptReason=null,this.runtimeInterruptReason=null,this.staticStageEndTime=1/0,this.runtimeStageEndTime=1/0,this.runtimeStageListeners=[],this.dynamicStageListeners=[],this.runtimeStagePromise=(0,h.createPromiseWithResolvers)(),this.dynamicStagePromise=(0,h.createPromiseWithResolvers)(),this.mayAbandon=!1,a&&(a.addEventListener("abort",()=>{let{reason:b}=a;this.currentStage<3&&(this.runtimeStagePromise.promise.catch(k),this.runtimeStagePromise.reject(b)),(this.currentStage<4||5===this.currentStage)&&(this.dynamicStagePromise.promise.catch(k),this.dynamicStagePromise.reject(b))},{once:!0}),this.mayAbandon=!0)}onStage(a,b){if(this.currentStage>=a)b();else if(3===a)this.runtimeStageListeners.push(b);else if(4===a)this.dynamicStageListeners.push(b);else throw Object.defineProperty(new g.InvariantError(`Invalid render stage: ${a}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}canSyncInterrupt(){if(1===this.currentStage)return!1;let a=this.hasRuntimePrefetch?4:3;return this.currentStage<a}syncInterruptCurrentStageWithReason(a){if(1!==this.currentStage){if(this.mayAbandon)return this.abandonRenderImpl();switch(this.currentStage){case 2:this.staticInterruptReason=a,this.advanceStage(4);return;case 3:this.hasRuntimePrefetch&&(this.runtimeInterruptReason=a,this.advanceStage(4));return}}}getStaticInterruptReason(){return this.staticInterruptReason}getRuntimeInterruptReason(){return this.runtimeInterruptReason}getStaticStageEndTime(){return this.staticStageEndTime}getRuntimeStageEndTime(){return this.runtimeStageEndTime}abandonRender(){if(!this.mayAbandon)throw Object.defineProperty(new g.InvariantError("`abandonRender` called on a stage controller that cannot be abandoned."),"__NEXT_ERROR_CODE",{value:"E938",enumerable:!1,configurable:!0});this.abandonRenderImpl()}abandonRenderImpl(){let{currentStage:a}=this;switch(a){case 2:this.currentStage=5,this.resolveRuntimeStage();return;case 3:this.currentStage=5;return}}advanceStage(a){if(a<=this.currentStage)return;let b=this.currentStage;if(this.currentStage=a,b<3&&a>=3&&(this.staticStageEndTime=performance.now()+performance.timeOrigin,this.resolveRuntimeStage()),b<4&&a>=4){this.runtimeStageEndTime=performance.now()+performance.timeOrigin,this.resolveDynamicStage();return}}resolveRuntimeStage(){let a=this.runtimeStageListeners;for(let b=0;b<a.length;b++)a[b]();a.length=0,this.runtimeStagePromise.resolve()}resolveDynamicStage(){let a=this.dynamicStageListeners;for(let b=0;b<a.length;b++)a[b]();a.length=0,this.dynamicStagePromise.resolve()}getStagePromise(a){switch(a){case 3:return this.runtimeStagePromise.promise;case 4:return this.dynamicStagePromise.promise;default:throw Object.defineProperty(new g.InvariantError(`Invalid render stage: ${a}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}}waitForStage(a){return this.getStagePromise(a)}delayUntilStage(a,b,c){var d,e,f;let g,h=(d=this.getStagePromise(a),e=b,f=c,g=new Promise((a,b)=>{d.then(a.bind(null,f),b)}),void 0!==e&&(g.displayName=e),g);return this.abortSignal&&h.catch(k),h}}function k(){}},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},24868,(a,b,c)=>{b.exports=a.x("fs/promises",()=>require("fs/promises"))},22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},6971,(a,b,c)=>{b.exports=a.x("sharp-20c6a5da84e2135f",()=>require("sharp-20c6a5da84e2135f"))},11032,a=>{"use strict";var b=a.i(90302),c=a.i(6512);a.s([],10549),a.i(10549),a.s(["00367a8de1cf9e8eef22053ba491b242c3954fc0ed",()=>b.logout,"00bf5bb6ae0836908cd09bca8b09567e320355edfe",()=>c.getAdminPackages,"400606749c04c88e038e57aabb785454ba0370a5e6",()=>c.bulkDeletePackages,"40c36cea8ee0ea340a719713fe6416e15ae2c9f16b",()=>c.deletePackage,"607c92be919f7a7a0f4c88af65e19c471f3103379d",()=>c.bulkUpdatePackages,"60fdbde4d29d67209ccf4876f8d564273206849906",()=>c.updatePackage],11032)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__01d32a4d._.js.map