module.exports=[53291,a=>{"use strict";var b=a.i(5050);let c=(0,b.createServerReference)("60fdbde4d29d67209ccf4876f8d564273206849906",b.callServer,void 0,b.findSourceMapURL,"updatePackage");a.s(["updatePackage",()=>c])},66636,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(5050);let e=(0,d.createServerReference)("4055b326a74a867b2261dc8bfe76b04b8b931db590",d.callServer,void 0,d.findSourceMapURL,"getPackageById");var f=a.i(53291),g=a.i(50944),h=a.i(20094);function i(a){return a.replace(/\D/g,"")}function j({params:a}){let d,{id:j}=(0,c.use)(a),k=(0,g.useRouter)(),l=(0,c.useRef)(null),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(0),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!0),K=function(a){if(!a)return"";let b=parseInt(a,10);return isNaN(b)?"":"Rp "+b.toLocaleString("id-ID")}(q),L=parseInt(u||"0",10);(0,c.useEffect)(()=>{e(j).then(a=>{a?(n(a.name),p(a.description||""),r(i(a.price)),t(a.category),v(a.stock.toString()),x(a.sortOrder),z(a.isActive),B(a.imageUrl||""),D(a.imageUrl||""),J(!1)):k.push("/admin/packages")}).catch(()=>{h.toast.error("Gagal memuat data paket."),J(!1)})},[j,k]);let M=async a=>{let b=a.target.files?.[0];if(!b)return;D(URL.createObjectURL(b)),F(!0);let c=new FormData;c.append("file",b);try{let a=await fetch("/api/upload",{method:"POST",body:c}),b=await a.json();b.success&&b.url?(B(b.url),h.toast.success("Gambar berhasil diupload!")):(h.toast.error(b.error||"Upload gagal"),D(A))}catch{h.toast.error("Upload gagal. Coba lagi."),D(A)}finally{F(!1)}},N=async a=>{if(a.preventDefault(),!m.trim())return void h.toast.error("Nama paket wajib diisi.");if(!q)return void h.toast.error("Harga wajib diisi.");if(!s)return void h.toast.error("Kategori wajib dipilih.");H(!0);let b=await (0,f.updatePackage)(j,{name:m.trim(),description:o.trim()||void 0,price:K,category:s,imageUrl:A||void 0,stock:L,isActive:y,sortOrder:w});b.success?(h.toast.success("Perubahan berhasil disimpan!"),setTimeout(()=>k.push("/admin/packages"),800)):(h.toast.error(b.error||"Gagal menyimpan paket."),H(!1))};return I?(0,b.jsx)("div",{className:"flex items-center justify-center py-24",children:(0,b.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full"})}):(0,b.jsxs)("div",{className:"max-w-2xl",children:[(0,b.jsxs)("header",{className:"mb-8 border-b border-neutral-800 pb-5",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Edit Paket"}),(0,b.jsx)("p",{className:"text-neutral-400 mt-1",children:"Perbarui informasi paket gift skin."})]}),(0,b.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Gambar Paket"}),(0,b.jsxs)("div",{className:"relative h-48 bg-neutral-900 border-2 border-dashed border-neutral-700 hover:border-blue-500/50 rounded-xl cursor-pointer transition-colors overflow-hidden",onClick:()=>l.current?.click(),children:[C?(0,b.jsx)("img",{src:C,alt:"preview",className:"w-full h-full object-cover"}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-2 text-neutral-500",children:[(0,b.jsx)("i",{className:"fa-solid fa-cloud-arrow-up text-3xl"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Klik untuk ganti gambar"}),(0,b.jsx)("span",{className:"text-xs",children:"JPG, PNG, WebP — maks. 10MB"})]}),E&&(0,b.jsxs)("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center gap-2",children:[(0,b.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full"}),(0,b.jsx)("span",{className:"text-xs text-neutral-400",children:"Mengupload & konversi ke WebP..."})]}),A&&!E&&(0,b.jsxs)("div",{className:"absolute bottom-2 left-2 right-2 flex items-center gap-1.5 bg-emerald-500/20 border border-emerald-500/30 px-2.5 py-1.5 rounded-lg",children:[(0,b.jsx)("i",{className:"fa-solid fa-check text-emerald-400 text-xs"}),(0,b.jsx)("span",{className:"text-xs text-emerald-400 font-medium",children:"Gambar sudah diset"}),(0,b.jsxs)("button",{type:"button",onClick:a=>{a.stopPropagation(),B(""),D("")},className:"ml-auto text-neutral-500 hover:text-red-400 transition-colors text-xs",children:[(0,b.jsx)("i",{className:"fa-solid fa-xmark"})," Hapus"]})]})]}),(0,b.jsx)("input",{ref:l,type:"file",accept:"image/*",className:"hidden",onChange:M})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("label",{className:"block text-sm font-semibold text-neutral-300",children:["Nama Paket ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:m,onChange:a=>n(a.target.value),className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl px-4 py-3 text-white placeholder:text-neutral-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none"})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("label",{className:"block text-sm font-semibold text-neutral-300",children:["Kategori ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{value:s,onChange:a=>t(a.target.value),className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl px-4 py-3 text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none appearance-none cursor-pointer",children:[(0,b.jsx)("option",{value:"",children:"Pilih Kategori..."}),(0,b.jsx)("option",{value:"Basic",children:"Basic"}),(0,b.jsx)("option",{value:"Premium",children:"Premium"}),(0,b.jsx)("option",{value:"Special",children:"Special"}),(0,b.jsx)("option",{value:"Event",children:"Event"}),(0,b.jsx)("option",{value:"Limited",children:"Limited"})]}),(0,b.jsx)("i",{className:"fa-solid fa-chevron-down absolute right-4 top-1/2 -translate-y-1/2 text-neutral-500 text-xs pointer-events-none"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Deskripsi"}),(0,b.jsx)("textarea",{value:o,onChange:a=>p(a.target.value),rows:3,className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl px-4 py-3 text-white placeholder:text-neutral-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none resize-none"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("label",{className:"block text-sm font-semibold text-neutral-300",children:["Harga ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-neutral-500 font-semibold text-sm select-none",children:"Rp"}),(0,b.jsx)("input",{type:"text",inputMode:"numeric",value:q?parseInt(q,10).toLocaleString("id-ID"):"",onChange:a=>{r(i(a.target.value))},placeholder:"0",className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl pl-10 pr-4 py-3 text-white font-mono text-lg placeholder:text-neutral-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none"})]}),q?(0,b.jsxs)("p",{className:"text-xs text-amber-400 flex items-center gap-1",children:[(0,b.jsx)("i",{className:"fa-solid fa-tag"}),(d=parseInt(q||"0",10))?d>=1e12?`${(d/1e12).toFixed(2).replace(".",",")} Triliun`:d>=1e9?`${(d/1e9).toFixed(2).replace(".",",")} Miliar`:d>=1e6?`${(d/1e6).toFixed(2).replace(".",",")} Juta`:d>=1e3?`${(d/1e3).toFixed(0)} Ribu`:d.toString():""," · disimpan sebagai ",(0,b.jsx)("span",{className:"font-mono",children:K})]}):(0,b.jsx)("p",{className:"text-xs text-neutral-600",children:"Ketik angka saja, format otomatis — cth: 50000"})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Stok"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-neutral-500 text-sm select-none",children:(0,b.jsx)("i",{className:"fa-solid fa-boxes-stacked"})}),(0,b.jsx)("input",{type:"text",inputMode:"numeric",value:u,onChange:a=>{v(i(a.target.value))},placeholder:"0",className:"w-full bg-neutral-900 border border-neutral-700 rounded-xl pl-10 pr-4 py-3 text-white font-mono text-lg placeholder:text-neutral-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/50 transition-all outline-none"})]}),(0,b.jsx)("p",{className:`text-xs flex items-center gap-1 ${0===L?"text-neutral-600":L<=5?"text-amber-400":"text-emerald-400"}`,children:0===L?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fa-solid fa-ban"})," Stok 0 — tidak bisa diorder"]}):L<=5?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fa-solid fa-triangle-exclamation"})," Hampir habis — ",L," unit tersisa"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fa-solid fa-check"})," ",L," unit tersedia"]})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Urutan Tampil"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>x(Math.max(0,w-1)),className:"w-10 h-12 flex items-center justify-center bg-neutral-800 hover:bg-neutral-700 rounded-xl border border-neutral-700 text-neutral-300 transition-colors shrink-0",children:(0,b.jsx)("i",{className:"fa-solid fa-minus text-xs"})}),(0,b.jsx)("div",{className:"flex-1 bg-neutral-900 border border-neutral-700 rounded-xl px-3 py-3 text-center font-mono text-white text-lg font-bold",children:w}),(0,b.jsx)("button",{type:"button",onClick:()=>x(w+1),className:"w-10 h-12 flex items-center justify-center bg-neutral-800 hover:bg-neutral-700 rounded-xl border border-neutral-700 text-neutral-300 transition-colors shrink-0",children:(0,b.jsx)("i",{className:"fa-solid fa-plus text-xs"})})]}),(0,b.jsx)("p",{className:"text-xs text-neutral-600",children:"Angka kecil muncul lebih dulu"})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-neutral-300",children:"Status Paket"}),(0,b.jsxs)("button",{type:"button",onClick:()=>z(!y),className:`w-full h-12 rounded-xl font-semibold text-sm transition-all border flex items-center justify-center gap-2 ${y?"bg-emerald-500/10 text-emerald-400 border-emerald-500/30 hover:bg-emerald-500/20":"bg-neutral-800 text-neutral-400 border-neutral-700 hover:bg-neutral-700"}`,children:[(0,b.jsx)("i",{className:`fa-solid ${y?"fa-eye":"fa-eye-slash"}`}),y?"Aktif — Tampil di publik":"Nonaktif — Disembunyikan"]}),(0,b.jsx)("p",{className:"text-xs text-neutral-600",children:y?"Pelanggan bisa melihat dan memesan paket ini.":"Paket tidak tampil di halaman utama."})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2 border-t border-neutral-800",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>k.back(),className:"px-6 py-3 rounded-xl bg-neutral-800 hover:bg-neutral-700 font-semibold transition-colors text-sm",children:[(0,b.jsx)("i",{className:"fa-solid fa-arrow-left mr-2 text-xs"})," Batal"]}),(0,b.jsx)("button",{type:"submit",disabled:G||E,className:"flex-1 py-3 px-6 bg-blue-500 hover:bg-blue-400 text-neutral-950 font-bold rounded-xl transition-all disabled:opacity-50 shadow-lg shadow-blue-500/20 text-sm",children:G?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fa-solid fa-circle-notch animate-spin mr-2"}),"Menyimpan..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fa-solid fa-floppy-disk mr-2"}),"Simpan Perubahan"]})})]})]})]})}a.s(["default",()=>j],66636)}];

//# sourceMappingURL=toro-store-app_src_285e4e29._.js.map